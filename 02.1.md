# 1.1 MySQL

## Установка MySQL

`sudo apt install -y mariadb-server mariadb-client`

`systemctl start mariadb` чтобы запустить

`systemctl enable mariadb`,  включить сервис базы данных.

`systemctl status mariadb` Эта команда покажет текущее состояние

---

## Настройка MySQL

После установки MariaDB рекомендуется также защитить его. Для этого выполните `sudo mysql_secure_installation`



**Enter current password for root (enter for none):** если у пользователя БД root уже есть пароль, введите его здесь. Если нет, просто нажмите Enter, чтобы продолжить.



**Set root password? [Y/n]:** ответьте y, чтобы установить пароль для root, и введите его два раза.



**Remove anonymous users? [Y/n]:** ответьте y, чтобы удалить анонимных пользователей, которые по умолчанию есть в БД.



**Disallow root login remotely? [Y/n]:** ответьте y, чтобы гарантировать, что пользователь root может подключаться к БД только локально. Для пользователей с правами root, которые хотят получить удаленный доступ, все равно надо сначала подключиться к серверу по SSH.



**Remove test database and access to it? [Y/n]:** после установки создается тестовая БД. По соображениям безопасности рекомендуется удалить эту базу, но поскольку в этой статье вы научитесь работать с MariaDB, вы должны сохранить ее. Поэтому выбираем n.



**Reload privilege tables now? [Y/n]:** ответьте y, чтобы сохранить и применить внесенные изменения.



`sudo mariadb -u root -p`  - Командная строка MySQL


## Создание пользователя

`CREATE USER 'test_user'@'localhost' IDENTIFIED BY 'password';`

Создать пользователя с именем `test_user`, который может подключаться с хоста `localhost`.

Просмотр всех пользователей:

`SELECT user, host FROM mysql.user;`

## Права пользователя MySQL

Создать пользователя - это ещё далеко не всё, теперь нужно назначить ему права. Для этого используется команда GRAT. У неё такой синтаксис:

`GRANT привилегии ON база_данных . таблица TO 'имя_пользователя'@'хост';`

Здесь можем дать определённые привилегии для опредёленного пользователя к базе данных или таблице. Если нужно дать права для всех баз данных или таблиц, используйте вместо названия звездочку - "*". Вот основные права пользователя MySQL, которые вы можете использовать:
```
ALL PRIVILEGES - все, кроме GRANT;
USAGE PRIVILEGES - никаких привилегий;
SELECT - делать выборки из таблиц;
INSERT - вставлять данные в таблицу;
UPDATE - обновлять данные в таблице;
DELETE - удалять данные из таблицы;
FILE - разрешает читать файлы на сервере;
CREATE - создавать таблицы или базы данных;
ALTER - изменять структуру таблиц;
INDEX - создавать индексы для таблиц;
DROP - удалять таблицы;
EVENT - обработка событий;
TRIGGER - создание триггеров.
```
Также доступны такие привилегии администрирования баз данных:
```
GRANT - изменять права пользователей;
SUPER - суперпользователь;
PROCESS - получение информации о состоянии MySQL;
RELOAD - позволяет перезагружать таблицы привилегий;
SHUTDOWN - позволяет отключать или перезапускать базу данных;
SHOW DATABASES - просмотр списка баз данных;
LOCK TABLES - блокирование таблиц при использовании SELECT;
REFERENCES - создание внешних ключей для связывания таблиц;
CREATE USER - создание пользователей;
```

Выдать права:

`GRANT SELECT, UPDATE, INSERT ON test_database . * TO 'test_user'@'localhost';`

Сделать `root`:

`GRANT ALL privileges ON test_db .* TO 'test_user'@'localhost';`

После обновления прав пользователя **необходимо обновить таблицу прав** пользователей MySQL  в памяти.

`FLUSH PRIVILEGES;`

Создание дополнительного суперпользователя:

```
GRANT ALL PRIVILEGES ON *.* TO 'admin'@'%' WITH GRANT OPTION;
FLUSH PRIVILEGES;
```

Посмотр привилегии пользователя:

`SHOW GRANTS FOR 'test_user'@'localhost';`

Удаления пользователя:

`DROP USER 'some_user'@'localhost';`



## Ссылки

- [Содержание](preface.md)
